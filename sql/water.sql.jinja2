SELECT
    ST_AsMVTGeom(way, {{unbuffered_bbox}}, {{extent}}, {{buffer}}) AS way
{% if zoom <= 8 %}
  FROM simplified_water_polygons
{% else %}
  FROM water_polygons
{% endif %}
  WHERE way && {{bbox}}
UNION ALL
SELECT
    ST_AsMVTGeom(ST_Collect(way), {{unbuffered_bbox}}, {{extent}}, {{buffer}}) AS way
  FROM planet_osm_polygon
  WHERE way && {{bbox}}
    AND (waterway IN ('dock', 'riverbank')
        OR landuse IN ('reservoir', 'basin')
        OR "natural" IN ('water'))
    AND way_area > 16 * {{coordinate_area}}
