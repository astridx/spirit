# Project Structure

## Overview

The Street Spirit contains the Street Spirit style with underlying vector tiles, code for generating [Shortbread Tiles](https://shortbread-tiles.org/), and code for generating the underlying database that powers both.

## Street Spirit client-side style

Street Spirit has a client-side Maplibre GL style. The root file for this is [`style.yaml`](/style.yaml) which relies on the included files in [`/style/`](/style/). These files are built with [Charites](https://unvt.github.io/charites/) to produce the Maplibre style.

## Street Spirit vector tiles

The client-side style is applied to vector tiles which are generated by [Tilekiln](https://github.com/pnorman/tilekiln) with the configuration file [`spirit.yaml`](/spirit.yaml). Layers are generated using the files in [`spirit/`](/spirit/).

## Shortbread vector tiles

Shortbread tiles implement the [Shortbread tile schema](https://shortbread-tiles.org/), a basic, lean, general-purpose vector tile schema for OpenStreetMap data. Unlike the vector tiles used internally by Street Spirit, these tiles are written with the goal of being usable by many styles. The Tilekiln configuration is [`shortbread.yaml`](/shortbread.yaml) with layer files in [`shortbread/`](/shortbread/) and [`shortbread_original/`](/shortbread_original/). These files are based on ones generated by osm2pgsql-themepark and the files in `shortbread_original/` have not yet been modified.

## Database loading

The database for both Street Spirit and Shortbread tiles is loaded with osm2pgsql, with utility scripts for other data sources like oceans. The lua transforms are [`spirit.lua`](/spirit.lua) and [`shortbread.lua`](/shortbread.lua). They rely on osm2pgsql themepark themes in [`themes/`](/themes/) and some themes in osm2pgsql-themepark itself. Some themes are common between the Street Spirit and Shortbread databases.

In the future there will be a lua transform which combines the Street Spirit and Shortbread ones, producing a database that can be used for either type of tiles.

Ocean polygons are loaded by [`scripts/get-external-data.py`](/scripts/get-external-data.py) as specified in [`external-data.yml`](/external-data.yml).
